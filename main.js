!function(){"use strict";var t={91:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},179:function(t,e,a){t.exports=a.p+"d472b462be953f331b62.js"}},e={};function a(o){var r=e[o];if(void 0!==r)return r.exports;var n=e[o]={exports:{}};return t[o](n,n.exports,a),n.exports}a.m=t,a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&!t;)t=o[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t}(),a.b=document.baseURI||self.location.href,function(){var t=a(91),e=a.n(t),o=new URL(a(179),a.b);e()(o);const r=document.querySelector("[data-setlimit]"),n=document.querySelector("[data-setlimit-button]"),l=document.querySelector("[data-setlimit-text]");n.addEventListener("click",(function(){const t=`${r.value} ккал`;l.innerText=t,localStorage.setItem("CaloriesLimit",`${t}`),r.value=""}));const c=document.querySelector("[data-current-table-container]"),i=document.querySelector("[data-current-table-body]"),d=document.querySelector("#tr-template").content.querySelector("[data-tr]");function s(t){c.classList.contains("table--hidden")&&c.classList.remove("table--hidden");const e=d.cloneNode(!0);e.setAttribute("id",`${t.id}`),e.querySelector("[data-title]").innerText=t.title,e.querySelector("[data-kcal]").innerText=t.kcal,e.querySelector("[data-gr]").innerText=t.weight,e.querySelector("[data-kcal-total]").innerText=t.kcalTotal,i.appendChild(e)}function u(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}function h(t,e,a,o,r,n,l){t.fillStyle=l,t.beginPath(),t.moveTo(e,a),t.arc(e,a,o,r,n),t.closePath(),t.fill()}class p{constructor(t){this.options=t,this.canvas=t.canvas,this.canvas.width=300,this.canvas.height=300,this.ctx=this.canvas.getContext("2d"),this.colors=t.colors,this.draw=function(){let t,e=0,a=0;for(let a of this.options.data)t=parseInt(a[1]),e+=t;let o=0;for(let r of this.options.data){t=parseInt(r[1]);let n=2*Math.PI*t/e;h(this.ctx,this.canvas.width/2,this.canvas.height/2,Math.min(this.canvas.width/2,this.canvas.height/2),o,o+n,this.colors[a%this.colors.length]),o+=n,a++}if(this.options.legend){a=0;let t="";for(let e of this.options.data)t+="<div><span style='display:inline-block;width:20px;background-color:"+this.colors[a++]+";'>&nbsp;</span> "+e[0]+"</div>";this.options.legend.innerHTML=t}}}}document.querySelector("[data-total-table-container]");const f=document.querySelector("[data-total-table-body]"),g=document.querySelector("#tr-total-template").content.querySelector("[data-total-tr]"),m=document.querySelector("[data-add-product]"),S=document.querySelector("[data-current-date]"),y=document.querySelector("[data-product-title]"),v=document.querySelector("[data-product-kcal]"),b=document.querySelector("[data-product-weight]"),w=document.querySelector("[data-form]"),q=document.querySelector("#diagram"),k=document.querySelector("#diagram-legend"),T=document.querySelector("[data-diagram-container]"),x=document.querySelector("[data-current-table-body]"),I=document.querySelector("[data-head-kcal]"),$=localStorage.getItem("CaloriesLimit"),O=document.querySelector("[data-total-table-body]"),L=document.querySelector("[data-filter]"),P=(new Date).toISOString().slice(0,10);l.innerText=$;const E=`_${Math.random().toString(30).substring(2,17)+Math.random().toString(30).substring(2,17)}`;m.addEventListener("click",(()=>{!function(t,e,a,o){let r;const n=[{date:`${t}`,title:`${e}`,kcal:`${a}`,weight:`${o}`,kcalTotal:""+parseInt(o)/100*parseInt(a),id:`Product${E}`}];localStorage.setItem(`Product${E}`,JSON.stringify(n[0])),r=JSON.parse(localStorage.getItem(`Product${E}`)),r.date==P&&s(r)}(S.value,y.value,v.value,b.value),w.reset(),M(),C(),location.reload()}));for(let t in localStorage)if(localStorage.hasOwnProperty(t)&&-1!==t.indexOf("Product")){let e;e=JSON.parse(localStorage.getItem(t)),e.date==P&&s(e)}function M(){const t=[],e=new Map;for(let a in localStorage)if(localStorage.hasOwnProperty(a)&&-1!==a.indexOf("Product")){let o;if(o=JSON.parse(localStorage.getItem(a)),o.date==P){const a={product:o.title,totalCal:parseInt(o.kcalTotal),color:u()};e.set(`${a.product}`,`${a.totalCal}`),t.push(a.color),T.classList.contains("diagram--hidden")&&T.classList.remove("diagram--hidden")}new p({canvas:q,data:e,colors:t,legend:k}).draw()}}function C(){const t=document.querySelectorAll("[data-kcal-total]"),e=document.querySelector("[data-settotal-text]"),a=[];if(0!=t.length){t.forEach((t=>{const e=parseInt(t.innerText);a.push(e)}));const o=a.reduce(((t,e)=>t+e));parseInt(l.innerText)<o?(l.innerText=`${$} (лимит калорий превышен)`,l.style.color="red"):(l.innerText=$,l.style.color="#ad43eb"),e.innerText=`${o} ккал`}}M(),window.addEventListener("click",(t=>{const e=t.target;if(e.hasAttribute("data-delete-current")){const t=e.closest(".table__row");localStorage.removeItem(`${t.id}`),x.removeChild(t),M(),C()}})),I.addEventListener("click",(t=>{const e=t.target,a=e.dataset.order;let o,r=[],n="ккал/100гр";for(let t in localStorage)if(localStorage.hasOwnProperty(t)&&-1!==t.indexOf("Product")){let e;e=JSON.parse(localStorage.getItem(t)),e.date==P&&r.push(e)}"desc"==a?(e.dataset.order="asc",o=r.sort(((t,e)=>parseInt(t.kcal)>parseInt(e.kcal)?1:-1)),n+="&#9660;"):(e.dataset.order="desc",o=r.sort(((t,e)=>parseInt(t.kcal)<parseInt(e.kcal)?1:-1)),n+="&#9650;"),x.innerHTML="",o.forEach((t=>{s(t)})),e.innerHTML=n})),L.addEventListener("keyup",(t=>{!function(t){const e=t.value.toUpperCase(),a=document.querySelector("[data-current-table]").querySelectorAll("tr");for(let t=0;t<a.length;t++){const o=a[t].querySelectorAll("td")[0];o&&(o.innerHTML.toUpperCase().indexOf(e)>-1?a[t].style.display="":a[t].style.display="none")}}(t.target)})),C();const N=[];for(let t in localStorage)if(localStorage.hasOwnProperty(t)&&-1!==t.indexOf("Product")){let e;e=JSON.parse(localStorage.getItem(t)),e.date!==P&&e.date==e.date&&N.push(e)}let A=N.sort(((t,e)=>{t.date!=e.date&&(t.date,e.date)})).reduce(((t,e)=>{let a=t.find((t=>t.date==e.date));return null!=a?(a.title.push(e.title),a.kcal.push(e.kcal),a.weight.push(e.weight),a.kcalTotal.push(e.kcalTotal),a.id.push(e.id)):t.push({date:e.date,title:[e.title],kcal:[e.kcal],weight:[e.weight],kcalTotal:[e.kcalTotal],id:[e.id]}),t}),[]);A.forEach(((t,e)=>{t.kcalTotal=t.kcalTotal.reduce(((t,e)=>parseInt(t)+parseInt(e))),t.masterID=e,function(t){const e=g.cloneNode(!0);e.setAttribute("id",`${t.masterID}`),e.querySelector("[data-total-date]").innerText=t.date,e.querySelector("[data-total-kcal]").innerText=t.kcalTotal,f.appendChild(e)}(t)})),window.addEventListener("click",(t=>{const e=t.target;if(e.hasAttribute("data-total-btn-delete")){const t=e.closest(".table-total__row");A.forEach((e=>{t.id==e.masterID&&(e.id.forEach((t=>{localStorage.removeItem(`${t}`)})),O.removeChild(t))}))}}))}()}();